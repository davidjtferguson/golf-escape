pico-8 cartridge // http://www.pico-8.com
version 41
__lua__

function _init()
 frames=0
 
 --backup to general use memory
 backupaddr1=0x4300
 backupaddr2=0x4310
end

function _update()
 frames+=1

 scrolltextures()
 
 if frames==60 then
  frames=0
 end
end

function scrolltextures()

 -- down stream
 scrollarea(65,10,2,8,1,0,1)

 --single square
 scrollarea(127,20,2,4,1,2)

 --long thin
 scrollarea(124,20,10,4,1,2)
 
 --full inner
 scrollarea(123,20,4,8)
 
 for s=76,79 do
  scrollarea(s,20,2,20,1,2)
 end
 
 --[[
 --block left side
 scrollarea(76,20,2,20,1,2)

 --block centre
 scrollarea(77,20,2,20,1,2)

 --block right side
 scrollarea(78,20,2,20,1,2)
 
 --tall column
 scrollarea(79,20,2,20,1,2)
]]
end

--sprite to start from
-- speed in frames
-- width (in bytes (each byte is 2 pixels))
-- height (in rows)
-- woff byte offset from left
-- hoff row offset from top
function scrollarea(spr,speed,w,h,woff,hoff,direction)
 if frames%speed!=0 then
  return
 end

 woff=woff or 0

 hoff=hoff or 0

 --direction=direction or -1
 direction=direction or 1

 addr=(512*(spr\16)+4*(spr%16))+woff
 
 --save row 1 to set buffers up
 memcpy(backupaddr2,addr+(64*hoff),w)
 
 -- i,imax,iadd=1+hoff,h-1-(2-hoff),2

 -- if direction<0 then
 --  i,imax,iadd=h-(2-hoff),1+hoff-1,-2
 -- end

 -- if h-1, works with offsets
 -- if h-3, works without offsets...
 for i=1+hoff,h-1-(2-hoff),2 do
 --for i=i,imax,iadd do
  pixelshift(addr+(64*i),addr+(64*(i+direction)),w)
 end

 pixelshift(addr+(64*(h-1+hoff)),addr+(64*hoff),w)
 
	--memcpy(addr+(64*(h-1+hoff)),backupaddr1,4)

 --pixelshift(addr+(64*hoff-1),addr+(64*hoff),w)
end

function pixelshift(addr1,addr2,w)
 swap(backupaddr1,backupaddr2,addr1,w)
 swap(backupaddr2,backupaddr1,addr2,w)
end

function swap(backupaddr,pastefromaddr,swapaddr,w)
 memcpy(backupaddr,swapaddr,w)
 memcpy(swapaddr,pastefromaddr,w)
end

function _draw()
 cls(0)
 print(addr)

 map(0,0,0,0,16,16)

end


function pixelshiftverbose()
	 
	 -- save row 2
	 memcpy(backupaddr1,addr+64,4)
	 
	 -- write row 1 to row 2
	 memcpy(addr+64,addr,4)
	 
	 -- save row 3
	 memcpy(backupaddr2,addr+(64*2),4)
	 
	 -- write row 2 to row 3
	 memcpy(addr+(64*2),backupaddr1,4)
	 
	 -- save row 4
	 memcpy(backupaddr1,addr+(64*3),4)
	 
	 --write row 3 to row 4
	 memcpy(addr+(64*3),backupaddr2,4)
	 
	 --save row 5
	 memcpy(backupaddr2,addr+(64*4),4)
	 
	 --write 4 to 5
	 memcpy(addr+(64*4),backupaddr1,4)
	 	 
	 -- save row 6
	 memcpy(backupaddr1,addr+(64*5),4)
	 
	 --write row 5 to row 6
	 memcpy(addr+(64*5),backupaddr2,4)
	 
	 --save row 7
	 memcpy(backupaddr2,addr+(64*6),4)
	 
	 --write 6 to 7
	 memcpy(addr+(64*6),backupaddr1,4)
	 
	 -- save row 8
	 memcpy(backupaddr1,addr+(64*7),4)
	 
	 --write 7 to 8
	 memcpy(addr+(64*7),backupaddr2,4)
	 
	 --write 8 to 1
	 memcpy(addr,backupaddr1,4)
	 
end
__gfx__
00000000777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000b3333b077777777000000007a9f6d200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000b3343b044444444000000007a9f6d200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000b3333b099999999000000007a9f6d200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000b343bb0ffffffff000000007a9f6d200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000b333bb066666666000000007a9f6d200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000b9333b0dddddddd000000007a9f6d200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000b3343b022222222000000007a9f6d200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000b3333b088888888000000007a9f6d200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000b3333b00000000000000000000000000000000000000000000000000000000000000000000555000000000000000000000000000000000000000000
000000000b3343b000000000000000000000000000000000000000000000000000000000000000005555d550000000000049bbbbbbbb44949bbbbb0000bbbb00
000000000b3333b00000000000000000000000000000000000000000000000000000000000000000555ddd50000000000b3333393343333333333bb00b3333b0
000000000b343bb000000000000000000000000000000000000000000000000000000000000000005551dd50000000000b3b333333333433333334b00b3b3340
000000000b333bb0000000000000000000000000000000000000000000000000000000000000000055511d50000000000b33333343b333333b3333b00b3333b0
000000000b9333b00000000000000000000000000000000000000000000000000000000000000000155bbb50000000000b33333333333333333333b00b3334b0
000000000b3343b0000000000000000000000000000000000000000000000000000000000000000011553bb0000000000b33b33333333333333339b00b9333b0
000000000b3333b000000000000000000000000000000000000000000000000000000000000000000b3553b0000000000b43333bb333333bb33b33b00b3333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b33333bb393333bb33333b00b3333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b333b333333b333333393b00b3333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b33333333333333333333b0043b3390
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b333333b3333333333333b0043333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000433333333333333333333400b3393b0
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004333933333433333b3333b00b3333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b33333333333333333333400b3334b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b33333bb333333bb33333400b3333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b33333bb333933bb33333b00b33b3b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b33b33333333333333343b00b3333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b433333333333333b3333b00b333340
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b33339333433333333333b009343340
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b33333333333333333333b0043333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b43333333333433339334b0043333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044bbbbbbbb49444bbbbb0000bbbb00
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000003333333300000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000003333343300b4bbbbb4bbbbbbbbbbbb0000bbbb00
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000333333330b333333b3333333393b33400b3343b0
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033933b330b3333333333333b333333b00b3333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000333333430b333b3333343333333333b00b3333b0
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000333433330b3333333333333333b334b004b339b0
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000003b3333330043494bbb4944bbbbbbbb0000bbbb00
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000003333333300000000000000000000000000000000
__map__
00000000000000000000004f0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4a000000000000004c4e005f00007b7b01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4100004f000000005c5d4d5d4e007b7b01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4100005f00004c005c6d5d5d5e00000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4100006f000000005f005c5d6e00000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
414c4d4e0000004c6e005c5d4d4e000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
415c5d5e004c7d6e004c5d5d5d5e000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
416c6d6e005f0000006c5d5d5d6e000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007c7d7e006c4e0000006c6d6e00000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000005f00004c4d7d4d4e000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000004f00005f004c5d6e006c5e000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007c5d7e006c4d5d6e0000005f000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000006f0000006c6e000000005f000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007f7f00007f000000000000005f000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007f7f7f7f00004f0000004c6e000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000005c7d7d7d5e00000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
